# gui.py

from graphics import *
from timer import Timer
from board import Board
from button import Button


class GUI:
    def __init__(self, h, w, m):
        self.height = h; self.width = w; self.mines = m
        self.win = GraphWin("Minesweeper", self.width * 42, self.height * 42 + 84)
        self.win.setCoords(-.5, -.5, self.width - .5, self.height + 1.5)
        self.board = Board(self.height, self.width, self.mines)
        self.list = self.board.getList()
        self.drawBoard()
        self.time = Timer()
        self.timer = Text(Point(6, 8), self.board.time())
        self.timer.setFace("courier")
        self.timer.setSize(36)
        self.timer.draw(self.win)
        self.mines = Text(Point(1, 8), self.board.flagCounter())
        while True:
            self.timer.setText(self.board.time())
            p = self.win.checkMouse()
            if p:
                self.handleClicks(p)
            elif self.win.checkKey().upper() == "F":
                self.board.toggleFlagging()


    def drawBoard(self):
        for y in self.list:
            for x in y:
                x.drawTile(y.index(x) + .012, self.list.index(y) - .012, self.win)

    def handleClicks(self, p):
        if p.getY() <= self.height - .5:
            self.board.tileClicked(self.board, int(p.getX() + .5), int(p.getY() + .5))

def main():
    game = GUI(8, 8, 10)      # don't change

main()
