# tile.py
from graphics import *


class Tile:
    def __init__(self):
        self.activated = False
        self.surrounding = None
        self.flagged = False
        self.mine = False

    def setFlag(self, x):
        """
        sets flag status
        :param x: bool
        :return: none
        """
        self.flagged = x

    def setState(self, x):
        """
        sets activation state
        :param x: bool
        :return: none
        """
        self.activated = x

    def isActivated(self):
        return self.activated

    def isFlagged(self):
        return self.flagged

    def setMine(self, x):
        """
        sets mine status
        :param x: bool
        :return: none
        """
        self.mine = x

    def hasMine(self):
        return self.mine

    def setSurrounding(self, x):
        """
        sets amount of surrounding mines
        :param x: int
        :return: none
        """
        self.surrounding = x

    def getSurrounding(self):
        return self.surrounding


class TileVisual(Tile):
    def __init__(self):
        self.rect = None
        self.label = None
        self.fill = None
        Tile.__init__(self)

    def makeLabel(self):
        if self.activated and self.mine:
            self.label = "Mine"
        elif self.activated:
            self.label = str(self.surrounding())
        elif self.flagged:
            self.label = "Flag"
        else:
            self.label = ""

    def fillColor(self):
        if self.activated and self.mine:
            self.fill = "red1"
        elif self.activated:
            self.fill = "grey2"
        elif self.flagged:
            self.fill = "grey1"
        else:
            self.fill = "grey1"

    def draw(self, p, win):
        self.__update()
        self.rect = Rectangle(Point(p.getX() - 20, p.getY() - 20), Point(p.getX + 20, p.getY() + 20))
        self.label = Text(p, self.label)
        self.rect.draw(win); self.label.draw(win)

    def __update(self):
        self.makeLabel(); self.fillColor()
